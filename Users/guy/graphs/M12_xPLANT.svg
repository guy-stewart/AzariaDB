<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 7.1.0 (20230121.1956)
 -->
<!-- Title: Automaton Pages: 1 -->
<svg width="696pt" height="1045pt"
 viewBox="0.00 0.00 696.00 1045.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1041)">
<title>Automaton</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1041 692,-1041 692,4 -4,4"/>
<!-- filename -->
<g id="node1" class="node">
<title>filename</title>
<polygon fill="none" stroke="black" points="0,-904.5 0,-1036.5 364,-1036.5 364,-904.5 0,-904.5"/>
<polygon fill="none" stroke="black" points="11,-1011.5 11,-1029.5 353,-1029.5 353,-1011.5 11,-1011.5"/>
<text text-anchor="start" x="152" y="-1018.5" font-family="Courier New" font-weight="bold" font-size="10.00">M12_xPLANT</text>
<polygon fill="none" stroke="black" points="11,-931.5 11,-1009.5 353,-1009.5 353,-931.5 11,-931.5"/>
<text text-anchor="start" x="14" y="-997.5" font-family="Courier New" font-size="10.00" fill="green">used in the temple to hold ingredients for spell making.</text>
<text text-anchor="start" x="14" y="-985.5" font-family="Courier New" font-size="10.00" fill="green">WIP1: The scroll holder</text>
<text text-anchor="start" x="14" y="-973.5" font-family="Courier New" font-size="10.00" fill="green">WIP2: The scroll map</text>
<text text-anchor="start" x="14" y="-961.5" font-family="Courier New" font-size="10.00" fill="green">SIG_SHOW: A scroll was dropped</text>
<text text-anchor="start" x="14" y="-949.5" font-family="Courier New" font-size="10.00" fill="green">SIG_HIDE: The scroll was grabbed</text>
<text text-anchor="start" x="14" y="-937.5" font-family="Courier New" font-size="10.00" fill="green">SIG_CLOSE: The spell is cast</text>
<polygon fill="none" stroke="black" points="11,-911.5 11,-929.5 353,-929.5 353,-911.5 11,-911.5"/>
<text text-anchor="start" x="136.99" y="-917.5" font-family="Courier New" font-size="10.00" fill="brown">start state = 0</text>
<polygon fill="none" stroke="black" points="8,-908.5 8,-1032.5 356,-1032.5 356,-908.5 8,-908.5"/>
</g>
<!-- 0 -->
<g id="node2" class="node">
<title>0</title>
<polyline fill="none" stroke="darkred" points="402,-959.5 416,-959.5"/>
<text text-anchor="start" x="405" y="-966.9" font-family="Courier New" font-weight="bold" font-size="14.00">0</text>
<path fill="none" stroke="darkred" d="M405.67,-956.5C405.67,-956.5 412.33,-956.5 412.33,-956.5 415.67,-956.5 419,-959.83 419,-963.17 419,-963.17 419,-977.83 419,-977.83 419,-981.17 415.67,-984.5 412.33,-984.5 412.33,-984.5 405.67,-984.5 405.67,-984.5 402.33,-984.5 399,-981.17 399,-977.83 399,-977.83 399,-963.17 399,-963.17 399,-959.83 402.33,-956.5 405.67,-956.5"/>
</g>
<!-- show_hint -->
<g id="node3" class="node">
<title>show_hint</title>
<polyline fill="none" stroke="darkred" points="145,-819 373,-819"/>
<text text-anchor="start" x="221.19" y="-826.4" font-family="Courier New" font-weight="bold" font-size="14.00">show_hint</text>
<polyline fill="none" stroke="darkred" points="145,-775 373,-775"/>
<polyline fill="none" stroke="darkred" points="373,-817 145,-817"/>
<text text-anchor="start" x="159.98" y="-805" font-family="Courier New" font-size="10.00" fill="green">1. There is a scroll attached</text>
<text text-anchor="start" x="159.98" y="-793" font-family="Courier New" font-size="10.00" fill="green">2. If this ingredient is required</text>
<text text-anchor="start" x="159.98" y="-781" font-family="Courier New" font-size="10.00" fill="green"> &#160;&#160;then a hint is displayed</text>
<polyline fill="none" stroke="darkred" points="145,-599 373,-599"/>
<polyline fill="none" stroke="darkred" points="373,-773 145,-773"/>
<text text-anchor="start" x="148" y="-761" font-family="Courier New" font-size="10.00" fill="blue">// find the ingredient</text>
<text text-anchor="start" x="148" y="-749" font-family="Courier New" font-size="10.00" fill="blue">// from S12_ING_x in wip2</text>
<text text-anchor="start" x="148" y="-737" font-family="Courier New" font-size="10.00" fill="blue">// and store in it bframe</text>
<text text-anchor="start" x="148" y="-725" font-family="Courier New" font-size="10.00" fill="blue">REF_MACHINE(WIP1);</text>
<text text-anchor="start" x="148" y="-713" font-family="Courier New" font-size="10.00" fill="blue">WPARM=R_WOBJECT;</text>
<text text-anchor="start" x="148" y="-701" font-family="Courier New" font-size="10.00" fill="blue">MAPi(WPARM,S12_SCROLL);</text>
<text text-anchor="start" x="148" y="-689" font-family="Courier New" font-size="10.00" fill="blue">BFRAME=WPARM;</text>
<text text-anchor="start" x="148" y="-677" font-family="Courier New" font-size="10.00" fill="blue">MAP(BFRAME,WIP2);</text>
<text text-anchor="start" x="148" y="-665" font-family="Courier New" font-size="10.00" fill="blue">if (BFRAME &gt; 0) {</text>
<text text-anchor="start" x="148" y="-653" font-family="Courier New" font-size="10.00" fill="blue"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;SHOW(WIP3); // show hint</text>
<text text-anchor="start" x="148" y="-641" font-family="Courier New" font-size="10.00" fill="blue"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;MOV(WACCEPT,BFRAME);</text>
<text text-anchor="start" x="148" y="-629" font-family="Courier New" font-size="10.00" fill="blue"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;MAPi(WACCEPT,S12_NATURE_REP);</text>
<text text-anchor="start" x="148" y="-617" font-family="Courier New" font-size="10.00" fill="blue"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;C_ACCEPT(WACCEPT);</text>
<text text-anchor="start" x="148" y="-605" font-family="Courier New" font-size="10.00" fill="blue">}</text>
<polyline fill="none" stroke="darkred" points="145,-579 373,-579"/>
<polyline fill="none" stroke="darkred" points="373,-597 145,-597"/>
<text text-anchor="start" x="238" y="-585" font-family="Courier New" font-size="10.00" fill="blue">SHOW();</text>
<path fill="none" stroke="darkred" d="M154,-576C154,-576 364,-576 364,-576 370,-576 376,-582 376,-588 376,-588 376,-832 376,-832 376,-838 370,-844 364,-844 364,-844 154,-844 154,-844 148,-844 142,-838 142,-832 142,-832 142,-588 142,-588 142,-582 148,-576 154,-576"/>
</g>
<!-- 0&#45;&gt;show_hint -->
<g id="edge1" class="edge">
<title>0&#45;&gt;show_hint</title>
<path fill="none" stroke="black" d="M404.47,-952.54C399.44,-937.22 389.73,-915.39 373,-904 346.89,-886.23 252.87,-909.71 232,-886 224.92,-877.95 220.26,-868.85 217.51,-859.13"/>
<polygon fill="black" stroke="black" points="220.95,-858.48 215.49,-849.4 214.09,-859.9 220.95,-858.48"/>
<text text-anchor="start" x="236" y="-874" font-family="Courier New" font-weight="bold" font-size="10.00" fill="orange">WAIT(,SIG_SHOW)</text>
</g>
<!-- show_hint&#45;&gt;0 -->
<g id="edge11" class="edge">
<title>show_hint&#45;&gt;0</title>
<path fill="none" stroke="black" d="M326.35,-847.71C334.71,-861.06 343.63,-874.06 353,-886 360.38,-895.41 365.57,-894.63 373,-904 382.29,-915.72 390.51,-930.16 396.74,-942.5"/>
<polygon fill="black" stroke="black" points="393.51,-943.85 401.02,-951.32 399.8,-940.79 393.51,-943.85"/>
<text text-anchor="start" x="357" y="-874" font-family="Courier New" font-weight="bold" font-size="10.00" fill="orange">WAIT(,SIG_HIDE)</text>
</g>
<!-- ready -->
<g id="node5" class="node">
<title>ready</title>
<polyline fill="none" stroke="darkred" points="288,-451 468,-451"/>
<text text-anchor="start" x="357" y="-458.4" font-family="Courier New" font-weight="bold" font-size="14.00">ready</text>
<polyline fill="none" stroke="darkred" points="288,-419 468,-419"/>
<polyline fill="none" stroke="darkred" points="468,-449 288,-449"/>
<text text-anchor="start" x="291" y="-437" font-family="Courier New" font-size="10.00" fill="green">1. There is a scroll attached</text>
<text text-anchor="start" x="291" y="-425" font-family="Courier New" font-size="10.00" fill="green">2. An ingredient is present</text>
<path fill="none" stroke="darkred" d="M297,-416C297,-416 459,-416 459,-416 465,-416 471,-422 471,-428 471,-428 471,-464 471,-464 471,-470 465,-476 459,-476 459,-476 297,-476 297,-476 291,-476 285,-470 285,-464 285,-464 285,-428 285,-428 285,-422 291,-416 297,-416"/>
</g>
<!-- show_hint&#45;&gt;ready -->
<g id="edge10" class="edge">
<title>show_hint&#45;&gt;ready</title>
<path fill="none" stroke="black" d="M245.26,-572.16C244.67,-540.05 247.14,-511.3 256,-498 259.5,-492.75 263.65,-488.03 268.28,-483.8"/>
<polygon fill="black" stroke="black" points="270.32,-486.65 275.91,-477.65 265.93,-481.2 270.32,-486.65"/>
<polygon fill="none" stroke="black" points="259,-527 259,-545 349,-545 349,-527 259,-527"/>
<text text-anchor="start" x="277" y="-534" font-family="Courier New" font-weight="bold" font-size="10.00" fill="orange">DROP(0,0)</text>
<polygon fill="none" stroke="black" points="259,-507 259,-525 349,-525 349,-507 259,-507"/>
<text text-anchor="start" x="262" y="-513" font-family="Courier New" font-size="10.00" fill="blue">SHOW(WOBJECT);</text>
<polygon fill="none" stroke="black" points="256,-504 256,-548 352,-548 352,-504 256,-504"/>
</g>
<!-- hold_if_invalid -->
<g id="node4" class="node">
<title>hold_if_invalid</title>
<polyline fill="none" stroke="darkred" points="226,-203 454,-203"/>
<text text-anchor="start" x="276.99" y="-210.4" font-family="Courier New" font-weight="bold" font-size="14.00">hold_if_invalid</text>
<polyline fill="none" stroke="darkred" points="226,-171 454,-171"/>
<polyline fill="none" stroke="darkred" points="454,-201 226,-201"/>
<text text-anchor="start" x="267.99" y="-189" font-family="Courier New" font-size="10.00" fill="green">Wait here if the object</text>
<text text-anchor="start" x="267.99" y="-177" font-family="Courier New" font-size="10.00" fill="green">is invalid for the spell</text>
<polyline fill="none" stroke="darkred" points="226,-7 454,-7"/>
<polyline fill="none" stroke="darkred" points="454,-169 226,-169"/>
<text text-anchor="start" x="229" y="-157" font-family="Courier New" font-size="10.00" fill="blue">// find the ingredient</text>
<text text-anchor="start" x="229" y="-145" font-family="Courier New" font-size="10.00" fill="blue">// from S12_ING_x in wip2</text>
<text text-anchor="start" x="229" y="-133" font-family="Courier New" font-size="10.00" fill="blue">// and store in it bframe</text>
<text text-anchor="start" x="229" y="-121" font-family="Courier New" font-size="10.00" fill="blue">REF_MACHINE(WIP1);</text>
<text text-anchor="start" x="229" y="-109" font-family="Courier New" font-size="10.00" fill="blue">WPARM=R_WOBJECT;</text>
<text text-anchor="start" x="229" y="-97" font-family="Courier New" font-size="10.00" fill="blue">MAPi(WPARM,S12_SCROLL);</text>
<text text-anchor="start" x="229" y="-85" font-family="Courier New" font-size="10.00" fill="blue">BFRAME=WPARM;</text>
<text text-anchor="start" x="229" y="-73" font-family="Courier New" font-size="10.00" fill="blue">MAP(BFRAME,WIP2);</text>
<text text-anchor="start" x="229" y="-61" font-family="Courier New" font-size="10.00" fill="blue">if (BFRAME &gt; 0) {</text>
<text text-anchor="start" x="229" y="-49" font-family="Courier New" font-size="10.00" fill="blue"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;MOV(WACCEPT,BFRAME);</text>
<text text-anchor="start" x="229" y="-37" font-family="Courier New" font-size="10.00" fill="blue"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;MAPi(WACCEPT,S12_NATURE_REP);</text>
<text text-anchor="start" x="229" y="-25" font-family="Courier New" font-size="10.00" fill="blue"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;C_ACCEPT(WACCEPT);</text>
<text text-anchor="start" x="229" y="-13" font-family="Courier New" font-size="10.00" fill="blue">}</text>
<path fill="none" stroke="darkred" d="M235,-4C235,-4 445,-4 445,-4 451,-4 457,-10 457,-16 457,-16 457,-216 457,-216 457,-222 451,-228 445,-228 445,-228 235,-228 235,-228 229,-228 223,-222 223,-216 223,-216 223,-16 223,-16 223,-10 229,-4 235,-4"/>
</g>
<!-- hold_if_invalid&#45;&gt;show_hint -->
<g id="edge2" class="edge">
<title>hold_if_invalid&#45;&gt;show_hint</title>
<path fill="none" stroke="black" d="M296.18,-231.92C267.33,-319.2 235.92,-442.79 242,-554 242.12,-556.23 242.25,-558.48 242.39,-560.74"/>
<polygon fill="black" stroke="black" points="238.9,-560.89 243.07,-570.63 245.88,-560.42 238.9,-560.89"/>
<text text-anchor="start" x="262" y="-382" font-family="Courier New" font-weight="bold" font-size="10.00" fill="orange">GRAB(,)</text>
</g>
<!-- hold_if_invalid&#45;&gt;ready -->
<g id="edge3" class="edge">
<title>hold_if_invalid&#45;&gt;ready</title>
<path fill="none" stroke="black" d="M324.54,-231.92C322.37,-271.68 323.52,-316.23 333,-356 336.78,-371.86 343.87,-388.09 351.32,-402.27"/>
<polygon fill="black" stroke="black" points="348.16,-403.79 356.03,-410.88 354.3,-400.43 348.16,-403.79"/>
<text text-anchor="start" x="337" y="-320" font-family="Courier New" font-weight="bold" font-size="10.00" fill="blue">IS_A(WOBJECT,WACCEPT)</text>
</g>
<!-- no_scroll -->
<g id="node6" class="node">
<title>no_scroll</title>
<polyline fill="none" stroke="darkred" points="487,-327 673,-327"/>
<text text-anchor="start" x="542.19" y="-334.4" font-family="Courier New" font-weight="bold" font-size="14.00">no_scroll</text>
<polyline fill="none" stroke="darkred" points="487,-295 673,-295"/>
<polyline fill="none" stroke="darkred" points="673,-325 487,-325"/>
<text text-anchor="start" x="490" y="-313" font-family="Courier New" font-size="10.00" fill="green">1. There is no scroll attached</text>
<text text-anchor="start" x="490" y="-301" font-family="Courier New" font-size="10.00" fill="green">2. An ingredient is present</text>
<path fill="none" stroke="darkred" d="M496,-292C496,-292 664,-292 664,-292 670,-292 676,-298 676,-304 676,-304 676,-340 676,-340 676,-346 670,-352 664,-352 664,-352 496,-352 496,-352 490,-352 484,-346 484,-340 484,-340 484,-304 484,-304 484,-298 490,-292 496,-292"/>
</g>
<!-- hold_if_invalid&#45;&gt;no_scroll -->
<g id="edge4" class="edge">
<title>hold_if_invalid&#45;&gt;no_scroll</title>
<path fill="none" stroke="black" d="M464.81,-209.12C481.35,-222.43 497.82,-236.28 513,-250 523.22,-259.23 533.7,-269.76 543.24,-279.82"/>
<polygon fill="black" stroke="black" points="540.6,-282.12 549.98,-287.03 545.71,-277.33 540.6,-282.12"/>
<text text-anchor="start" x="536" y="-258" font-family="Courier New" font-weight="bold" font-size="10.00" fill="orange">WAIT(,SIG_HIDE)</text>
</g>
<!-- ready&#45;&gt;0 -->
<g id="edge9" class="edge">
<title>ready&#45;&gt;0</title>
<path fill="none" stroke="black" d="M433.22,-479.72C438.72,-485.14 443.54,-491.24 447,-498 486.25,-574.78 470.91,-802.1 451,-886 446.2,-906.2 435.71,-927.07 426.41,-942.9"/>
<polygon fill="black" stroke="black" points="423.55,-940.85 421.33,-951.21 429.53,-944.5 423.55,-940.85"/>
<polygon fill="none" stroke="black" points="474,-727 474,-745 588,-745 588,-727 474,-727"/>
<text text-anchor="start" x="482.99" y="-734" font-family="Courier New" font-weight="bold" font-size="10.00" fill="orange">WAIT(,SIG_CLOSE)</text>
<polygon fill="none" stroke="black" points="474,-707 474,-725 588,-725 588,-707 474,-707"/>
<text text-anchor="start" x="477" y="-713" font-family="Courier New" font-size="10.00" fill="green">consume the object</text>
<polygon fill="none" stroke="black" points="474,-675 474,-705 588,-705 588,-675 474,-675"/>
<text text-anchor="start" x="501" y="-693" font-family="Courier New" font-size="10.00" fill="blue">WOBJECT=0;</text>
<text text-anchor="start" x="501" y="-681" font-family="Courier New" font-size="10.00" fill="blue">ASHOW();</text>
<polygon fill="none" stroke="black" points="471,-672 471,-748 591,-748 591,-672 471,-672"/>
</g>
<!-- ready&#45;&gt;show_hint -->
<g id="edge7" class="edge">
<title>ready&#45;&gt;show_hint</title>
<path fill="none" stroke="black" d="M374.35,-479.71C371.2,-501.36 365.59,-530.06 356,-554 354.94,-556.64 353.84,-559.29 352.69,-561.94"/>
<polygon fill="black" stroke="black" points="349.63,-560.22 348.71,-570.78 356.01,-563.1 349.63,-560.22"/>
<polygon fill="none" stroke="black" points="374,-527 374,-545 440,-545 440,-527 374,-527"/>
<text text-anchor="start" x="380" y="-534" font-family="Courier New" font-weight="bold" font-size="10.00" fill="orange">GRAB(0,0)</text>
<polygon fill="none" stroke="black" points="374,-507 374,-525 440,-525 440,-507 374,-507"/>
<text text-anchor="start" x="377" y="-513" font-family="Courier New" font-size="10.00" fill="blue">WOBJECT=0;</text>
<polygon fill="none" stroke="black" points="371,-504 371,-548 443,-548 443,-504 371,-504"/>
</g>
<!-- ready&#45;&gt;no_scroll -->
<g id="edge8" class="edge">
<title>ready&#45;&gt;no_scroll</title>
<path fill="none" stroke="black" d="M432.14,-412.07C451.91,-400.06 474.45,-386.4 495,-374 501.69,-369.97 508.67,-365.76 515.64,-361.57"/>
<polygon fill="black" stroke="black" points="517.04,-364.81 523.81,-356.66 513.44,-358.81 517.04,-364.81"/>
<text text-anchor="start" x="499" y="-382" font-family="Courier New" font-weight="bold" font-size="10.00" fill="orange">WAIT(0,SIG_HIDE)</text>
</g>
<!-- no_scroll&#45;&gt;0 -->
<g id="edge5" class="edge">
<title>no_scroll&#45;&gt;0</title>
<path fill="none" stroke="black" d="M594.22,-355.99C596.2,-361.89 597.93,-368.05 599,-374 600.58,-382.75 599.04,-385.11 599,-394 598.11,-595.78 691.83,-670.96 595,-848 563.35,-905.87 490.99,-940.64 446.43,-957.35"/>
<polygon fill="black" stroke="black" points="445.38,-954.01 437.16,-960.7 447.76,-960.59 445.38,-954.01"/>
<polygon fill="none" stroke="black" points="619,-533 619,-551 685,-551 685,-533 619,-533"/>
<text text-anchor="start" x="625" y="-540" font-family="Courier New" font-weight="bold" font-size="10.00" fill="orange">GRAB(0,0)</text>
<polygon fill="none" stroke="black" points="619,-501 619,-531 685,-531 685,-501 619,-501"/>
<text text-anchor="start" x="622" y="-519" font-family="Courier New" font-size="10.00" fill="blue">WOBJECT=0;</text>
<text text-anchor="start" x="622" y="-507" font-family="Courier New" font-size="10.00" fill="blue">SHOW();</text>
<polygon fill="none" stroke="black" points="616,-498 616,-554 688,-554 688,-498 616,-498"/>
</g>
<!-- no_scroll&#45;&gt;hold_if_invalid -->
<g id="edge6" class="edge">
<title>no_scroll&#45;&gt;hold_if_invalid</title>
<path fill="none" stroke="black" d="M476.25,-291.71C439.46,-281.15 406.63,-271.45 405,-270 395.83,-261.86 387.92,-252.2 381.09,-241.76"/>
<polygon fill="black" stroke="black" points="384.1,-239.98 375.91,-233.26 378.13,-243.62 384.1,-239.98"/>
<text text-anchor="start" x="409" y="-258" font-family="Courier New" font-weight="bold" font-size="10.00" fill="orange">WAIT(0,SIG_SHOW)</text>
</g>
</g>
</svg>
